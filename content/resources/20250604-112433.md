---
title: Deploy more efficiently with templating
draft: false
date: 2024-01-02
tags:
  - templating
  - serverless
  - CI/CD
---

You are building a website, a simple frontend that needs to call the database for \[total lead drops this week]. Your website is still at an early stage, with only a few features. At this point, you wonder whether you need a real backend or not. But to deploy a backend properly, it would involve docker, backend database, storage, DNS, load balancer, and other things. But it looks like you don't have enough time, so you decide to go with serverless, since it takes less time to set up and you don't have to worry about scaling.

So you create a serverless function to get the information from the database. But the frontend can't call the function directly, so you have to expose the function through an API gateway, so the frontend can talk to it. You are happy with the current setup, since it saves you a lot of effort in creating a real backend.

But your business is still trying to find its way, so you had an idea to tweak the query often. Then you are getting more annoyed that every time you have to update the query, you have to go to the cloud console and manually update the query in your serverless app. You feel like there should be an easier way of just updating a few lines of code. You found something called CI/CD. You played around with it a bit, then you smiled because this means you don't ever have to log in to the cloud console again as long as you connect the CI/CD to your serverless code properly.

A few weeks went by, and you couldn't be happier. Then you had an idea for a few more features, but at this point, you still are not ready for deploying a real backend yet, so you have to create a few serverless functions for each feature. Suddenly you realized that you forgot how you set up the first serverless function, not to mention how to connect it to the API gateway and connect it to CI/CD. You are sweating, worried about having to do everything by hand every time you update the code.

Luckily it's 2022, and the DevOps tools have improved a lot compared to the past. Apparently, smart people use a type of template to create serverless functions, since they realized that most of the configuration differences are your code, not the infrastructure setup.

So basically, if you want to create a serverless API to use with the frontend, this template would:

1. Create a serverless function
2. Put your code into the function
3. Connect the function with the API gateway
4. Also add a CI/CD connection so the whole flow would be triggered again from start to finish after a code update

Most leading Infrastructure as Code (IaC) tools have this feature, but what if you are not familiar with HashiCorp configuration language? Then you might find tools with a normal programming language interface more familiar, and Pulumi is a good choice. HashiCorp also recently released CDK to do the same thing if you want to try it out. But for a start, you could check out [Pulumi's Deployments Mini-Challenge](https://www.pulumi.com/challenge/deployments/) to try deploying a serverless function with templating and CI/CD. For Terraform CDK, check out [this repo](https://github.com/cdktf/cdktf-integration-serverless-example).

[Reference](https://karnwong.me/posts/rss.xml)
