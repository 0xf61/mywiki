---
title: Deploy more efficiently with templating
draft: false
date: 2024-01-03
tags:
  - CI/CD
  - serverless
  - Pulumi
---

You are building a website, a simple frontend that needs to call the database for \[total lead drops this week]. Your website is still new, with only a few features. You are thinking about whether you need a real backend or not. But to set up a backend properly, it would involve docker, backend database, storage, DNS, load balancer, and other things. But you don't have enough time, so you decide to use serverless, since it takes less time and you don't have to worry about scaling.

So you create a serverless function to get the information from the database. But the frontend can't call the function directly, so you have to use an API gateway so the frontend can talk to it. You are happy with the current setup because it saves you a lot of work in creating a real backend.

But your business is still trying to grow, so you want to change the query every so often. You are getting annoyed that every time you have to update the query, you have to go to the cloud console and manually update the query in your serverless app. You think there should be an easier way of just updating a few lines of code. You find something called CI/CD. You play around with it a bit, and you are happy because this means you don't ever have to log in to the cloud console again as long as you connect the CI/CD to your serverless code properly.

A few weeks go by, and you are very happy. Then you have an idea for a few more features, but you are still not ready to set up a real backend yet, so you have to create a few serverless functions for each feature. Suddenly you realize that you forgot how you set up the first serverless function, and how to connect it to the API gateway, and hook it up to CI/CD. You are worried that you will have to do everything by hand every time you update the code.

Luckily, it's 2022, and the devops tools have improved a lot. Smart people use a template to create serverless functions, since they realized that most of the differences are your code, not the infrastructure setup.

So if you want to create a serverless API to use with the frontend, this template would:

1. Create a serverless function
2. Put your code into the function
3. Connect the function with the API gateway
4. Also add a CI/CD hook so the whole process would be triggered again after a git push

Most leading IaC tools have this feature, but what if you are not familiar with HashiCorp configuration language? Then you might find tools with a normal programming language interface more familiar, and Pulumi is one of these. HashiCorp also recently released CDK to do the same thing if you want to try it. But to start, you can check out [Pulumi's Deployments Mini-Challenge](https://www.pulumi.com/challenge/deployments/) to try deploying a serverless function with templating and CI/CD. For Terraform CDK, check out [this repo](https://github.com/cdktf/cdktf-integration-serverless-example).

[Reference](https://karnwong.me/posts/rss.xml)
