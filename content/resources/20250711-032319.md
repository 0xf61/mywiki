---
title: SCIM Hunting - Beyond SSO
draft: false
date: 2024-01-02
tags:
  - SCIM
  - SSO
  - Security
---

[2023](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Office Documents Poisoning in SHVE](https://blog.doyensec.com/2023/11/03/Office-Document-Poisoning.html)
[September](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Client-side JavaScript Instrumentation](https://blog.doyensec.com/2023/09/25/clientside-javascript-instrumentation.html)
[August](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Introducing Session Hijacking Visual Exploitation (SHVE): An Innovative Open-Source Tool for XSS Exploitation](https://blog.doyensec.com/2023/08/31/introducing-session-hijacking-visual-exploitation.html)
- [• InQL v5: A Technical Deep Dive](https://blog.doyensec.com/2023/08/17/inql-v5.html)
[July](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Huawei Theme Manager Arbitrary Code Execution](https://blog.doyensec.com/2023/07/26/huawei-theme-arbitrary-code-exec.html)
- [• Streamlining Websocket Pentesting with wsrepl](https://blog.doyensec.com/2023/07/18/streamlining-websocket-pentesting-with-wsrepl.html)
[June](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Messing Around With AWS Batch For Privilege Escalations](https://blog.doyensec.com/2023/06/13/messing-around-with-aws-batch-for-privilege-escalations.html)
- [• Logistics for a Remote Company](https://blog.doyensec.com/2023/06/06/logistics.html)
[May](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Reversing Pickles with r2pickledec](https://blog.doyensec.com/2023/06/01/r2pickledec.html)
- [• Testing Zero Touch Production Platforms and Safe Proxies](https://blog.doyensec.com/2023/05/04/testing-ztp-platforms-a-primer.html)
[March](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• The Case For Improving Crypto Wallet Security](https://blog.doyensec.com/2023/03/28/wallet-info.html)
- [• Windows Installer EOP (CVE-2023-21800)](https://blog.doyensec.com/2023/03/21/windows-installer.html)
- [• SSRF Cross Protocol Redirect Bypass](https://blog.doyensec.com/2023/03/16/ssrf-remediation-bypass.html)
[February](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• A New Vector For “Dirty” Arbitrary File Write to RCE](https://blog.doyensec.com/2023/02/28/new-vector-for-dirty-arbitrary-file-write-2-rce.html)
- [• Introducing Proxy Enriched Sequence Diagrams (PESD)](https://blog.doyensec.com/2023/02/14/pesd-extension-public-release.html)
[January](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Tampering User Attributes In AWS Cognito User Pools](https://blog.doyensec.com/2023/01/24/tampering-unrestricted-user-attributes-aws-cognito.html)
- [• ImageMagick Security Policy Evaluator](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)
[2022](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[December](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• safeurl for Go](https://blog.doyensec.com/2022/12/13/safeurl.html)
[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Let's speak AJP](https://blog.doyensec.com/2022/11/15/learning-ajp.html)
- [• Recruiting Security Researchers Remotely](https://blog.doyensec.com/2022/11/09/recruiting-security-researchers.html)
[October](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Visual Studio Code Jupyter Notebook RCE](https://blog.doyensec.com/2022/10/27/jupytervscode.html)
- [• The Danger of Falling to System Role in AWS SDK Client](https://blog.doyensec.com/2022/10/18/cloudsectidbit-dataimport.html)
- [• On Bypassing eBPF Security Monitoring](https://blog.doyensec.com/2022/10/11/ebpf-bypass-security-monitoring.html)
- [• Comparing Semgrep and CodeQL](https://blog.doyensec.com/2022/10/06/semgrep-codeql.html)
[September](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Diving Into Electron Web API Permissions](https://blog.doyensec.com/2022/09/27/electron-api-default-permissions.html)
- [• ElectroNG, our premium SAST tool released!](https://blog.doyensec.com/2022/09/06/electrong-launch.html)
[August](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• My Internship Experience at Doyensec](https://blog.doyensec.com/2022/08/24/intern-experience.html)
[July](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Dependency Confusion](https://blog.doyensec.com/2022/07/21/dependency-confusion.html)
[June](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Apache Pinot SQLi and RCE Cheat Sheet](https://blog.doyensec.com/2022/06/09/apache-pinot-sqli-rce.html)
[April](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Introduction to VirtualBox security research](https://blog.doyensec.com/2022/04/26/vbox-fuzzing.html)
[February](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• H1.Jack, The Game](https://blog.doyensec.com/2022/02/16/h1jack-the-game.html)
[2021](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[May](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• That single GraphQL issue that you keep missing](https://blog.doyensec.com/2021/05/20/graphql-csrf.html)
[March](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Regexploit: DoS-able Regular Expressions](https://blog.doyensec.com/2021/03/11/regexploit.html)
[February](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Electron APIs Misuse: An Attacker’s First Choice](https://blog.doyensec.com/2021/02/16/electron-apis-misuse.html)
[2020](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[December](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Psychology of Remote Work](https://blog.doyensec.com/2020/12/17/psychology-of-remote-work.html)
- [• Novel Abuses On Wi-Fi Direct Mobile File Transfers](https://blog.doyensec.com/2020/12/10/novel-abuses-wifi-direct-mobile-file-transfers.html)
[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• InQL Scanner v3 - Just Released!](https://blog.doyensec.com/2020/11/19/inql-scanner-v3.html)
[September](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Fuzzing JavaScript Engines with Fuzzilli](https://blog.doyensec.com/2020/09/09/fuzzilli-jerryscript.html)
[August](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• CSRF Protection Bypass in Play Framework](https://blog.doyensec.com/2020/08/20/playframework-csrf-bypass.html)
[June](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• InQL Scanner v2 is out!](https://blog.doyensec.com/2020/06/11/inql-scanner-v2.html)
[May](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Fuzzing TLS certificates from their ASN.1 grammar](https://blog.doyensec.com/2020/05/14/asn1fuzz.html)
[April](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Researching Polymorphic Images for XSS on Google Scholar](https://blog.doyensec.com/2020/04/30/polymorphic-images-for-xss.html)
- [• LibreSSL and OSS-Fuzz](https://blog.doyensec.com/2020/04/08/libressl-fuzzer.html)
[March](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• InQL Scanner](https://blog.doyensec.com/2020/03/26/graphql-scanner.html)
- [• Don't Clone That Repo: Visual Studio Code^2 Execution](https://blog.doyensec.com/2020/03/16/vscode_codeexec.html)
- [• 2019 Gravitational Security Audit Results](https://blog.doyensec.com/2020/03/02/gravitational-audit.html)
[February](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Signature Validation Bypass Leading to RCE In Electron-Updater](https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html)
- [• Security Analysis of the Solo Firmware](https://blog.doyensec.com/2020/02/19/solokeys-audit.html)
- [• Heap Overflow in F-Secure Internet Gatekeeper](https://blog.doyensec.com/2020/02/03/heap-exploit.html)
[2019](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Internship at Doyensec](https://blog.doyensec.com/2019/11/05/internship-at-doyensec.html)
[August](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• One Bug To Rule Them All: Modern Android Password Managers and FLAG\_SECURE Misuse](https://blog.doyensec.com/2019/08/22/modern-password-managers-flag-secure.html)
[July](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Lessons in auditing cryptocurrency wallets, systems, and infrastructures](https://blog.doyensec.com/2019/08/01/common-crypto-bugs.html)
- [• Jackson gadgets - Anatomy of a vulnerability](https://blog.doyensec.com/2019/07/22/jackson-gadgets.html)
- [• Electron Security Workshop](https://blog.doyensec.com/2019/07/03/electron-security-workshop.html)
[June](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Electronegativity 1.3.0 released!](https://blog.doyensec.com/2019/06/11/electronegativity-1.3.html)
[April](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• On insecure zip handling, Rubyzip and Metasploit RCE (CVE-2019-5624)](https://blog.doyensec.com/2019/04/24/rubyzip-bug.html)
- [• Subverting Electron Apps via Insecure Preload](https://blog.doyensec.com/2019/04/03/subverting-electron-apps-via-insecure-preload.html)
[January](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Electronegativity is finally out!](https://blog.doyensec.com/2019/01/24/electronegativity.html)
[2018](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Introducing burp-rest-api v2](https://blog.doyensec.com/2018/11/05/burp-rest-api-v2.html)
[July](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Instrumenting Electron Apps for Security Testing](https://blog.doyensec.com/2018/07/19/instrumenting-electron-app.html)
[May](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Electron Windows Protocol Handler MITM/RCE (bypass for CVE-2018-1000006 fix)](https://blog.doyensec.com/2018/05/24/electron-win-protocol-handler-bug-bypass.html)
- [• GraphQL - Security Overview and Testing Tips](https://blog.doyensec.com/2018/05/17/graphql-security-overview.html)
[2017](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)

[November](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• We're hiring - Join Doyensec!](https://blog.doyensec.com/2017/11/27/we-are-hiring.html)
- [• Staring into the Spotlight](https://blog.doyensec.com/2017/11/15/osx-spotlight.html)
[August](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Modern Alchemy: Turning XSS into RCE](https://blog.doyensec.com/2017/08/03/electron-framework-security.html)
[March](https://blog.doyensec.com/2025/05/08/scim-hunting.html#)
- [• Developing Burp Suite Extensions training](https://blog.doyensec.com/2017/03/02/training-burp.html)

© 2025 [Doyensec LLC](https://doyensec.com/) [![](https://blog.doyensec.com/public/images/rss.png)](https://blog.doyensec.com/atom.xml "RSS")

# SCIM Hunting - Beyond SSO

May 8, 2025 - Posted by Francesco Lacerenza

## Introduction

Single Sign-On (SSO) related bugs have received a lot of attention and public discussion in recent years. Here are a few examples:

- [Common OAuth Vulnerabilities](https://blog.doyensec.com/2025/01/30/oauth-common-vulnerabilities.html)
- [Sign in as anyone: Bypassing SAML SSO authentication with parser differentials](https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials/)
- [Account hijacking using “dirty dancing” in sign-in OAuth-flows](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/)

There are many more examples like these.

Systems using a custom implementation are often the most affected because integrating SSO with a platform’s user system is not easy.

However, while SSO is often the focus, another standard is often not tested as much: **SCIM (System for Cross-domain Identity Management)**. In this post, we will explore its main features and the security problems we often find when testing our clients’ implementations.

![SCIM](https://blog.doyensec.com/public/images/scim.png)

## Table of Contents

1. [SCIM 101](https://blog.doyensec.com/2025/05/08/scim-hunting.html#scim-101)
- [Core Components](https://blog.doyensec.com/2025/05/08/scim-hunting.html#core-components)
- [What about the implementations?](https://blog.doyensec.com/2025/05/08/scim-hunting.html#what-about-the-implementations)
- [Mind The Impact](https://blog.doyensec.com/2025/05/08/scim-hunting.html#mind-the-impact)
1. [Hunting for Bugs](https://blog.doyensec.com/2025/05/08/scim-hunting.html#hunting-for-bugs)
- [Auth Bypasses](https://blog.doyensec.com/2025/05/08/scim-hunting.html#auth-bypasses)
- [SCIM Token Management](https://blog.doyensec.com/2025/05/08/scim-token-management)
- [Unwanted User Re-provisioning Fallbacks](https://blog.doyensec.com/2025/05/08/scim-hunting.html#unwanted-user-re-provisioning-fallbacks)
- [Internal Attributes Manipulation](https://blog.doyensec.com/2025/05/08/scim-hunting.html#internal-attributes-manipulation)
- [Verification Bypasses](https://blog.doyensec.com/2025/05/08/scim-hunting.html#verification-bypasses)
- [Account Takeover](https://blog.doyensec.com/2025/05/08/scim-hunting.html#account-takeover)
1. [Extra Focus Areas](https://blog.doyensec.com/2025/05/08/scim-hunting.html#extra-focus-areas)
- [Checks Bypass Via SCIM Ops Syntax](https://blog.doyensec.com/2025/05/08/scim-hunting.html#extra-checks-bypass-via-scim-ops-syntax)
- [Bulk Ops Order Evaluation](https://blog.doyensec.com/2025/05/08/scim-hunting.html#extra2-bulk-ops-order-evaluation)
- [JSON Interoperability](https://blog.doyensec.com/2025/05/08/scim-hunting.html#json-interoperability)
1. [Conclusions](https://blog.doyensec.com/2025/05/08/scim-hunting.html#conclusions)

## SCIM 101

SCIM is a standard that automates the adding and removing of user accounts across different systems, ensuring consistent access.

The standard is defined in these RFCs: [RFC7642](https://datatracker.ietf.org/doc/html/rfc7642), [RFC7644](https://datatracker.ietf.org/doc/html/rfc7644), [RFC7643](https://datatracker.ietf.org/doc/html/rfc7643).

While it is **not specifically designed to be an IdP-to-SP protocol**, but rather a general user syncing protocol for cloud environments, it is often used in the IdP-SP relationship.

#### Core Components

In short, the standard defines a set of RESTful APIs provided by the Service Providers (SP). These APIs can be called by other systems (mostly Identity Providers) to update the user list.

![Image 1](https://blog.doyensec.com/public/images/scim-diagram.png)![Image 2](https://blog.doyensec.com/public/images/scim_resource_examples.png)

It provides REST APIs with the following operations to edit the managed objects (see [scim.cloud](https://scim.cloud/)):

- **Create**: POST `https://example-SP.com/{v}/{resource}`
- **Read**: GET `https://example-SP.com/{v}/{resource}/{id}`
- **Replace**: PUT `https://example-SP.com/{v}/{resource}/{id}`
- **Delete**: DELETE `https://example-SP.com/{v}/{resource}/{id}`
- **Update**: PATCH `https://example-SP.com/{v}/{resource}/{id}`
- **Search**: GET `https://example-SP.com/{v}/{resource}?<SEARCH_PARAMS>`
- **Bulk**: POST `https://example-SP.com/{v}/Bulk`

So, SCIM is a set of APIs that can perform CRUD operations on JSON objects that represent user identities.

**Core Functionalities**

If you want to find bugs in a SCIM implementation, here is a list of core functionalities to review:

1. **Server Config & Authn/z Middlewares** - SCIM does not define its authentication/authorization method, so it will always be custom.
2. **SCIM Object to Internal Objects Mapping Function** - How the backend converts/links the SCIM objects to the internal user and group objects. These are often more complex and have many rules and safety checks.

Some examples: internal attributes that should not be user-controlled, platform-specific attributes not allowed in SCIM, etc.
1. **Operations Exec Logic** - Changes to identity-related objects often trigger application processes. For example: an `email` update should trigger a confirmation flow, and a `username` update should trigger ownership/pending invitations/re-auth checks.

#### Mind The Impact

Because it is direct IdP-to-SP communication, most of the resulting issues will require a certain level of access in either the IdP or SP. However, the impact might be very high in multi-tenant platforms where SCIM users may lack the tenant-isolation logic.

## Hunting for Bugs

Here are some examples of bugs you should look for when auditing SCIM implementations.

### Auth Bypasses

A few months ago, we published our advisory for _[Unauthenticated SCIM Operations In Casdoor IdP Instances](https://doyensec.com/resources/Doyensec_Advisory_UnauthenticatedSCIM-CasdoorIdP.pdf)_. Casdoor is an open-source identity solution that supports various authentication standards such as OAuth, SAML, OIDC, etc. It also includes SCIM, which means the Casdoor (IdP) would allow external systems to change its users.

Casdoor used the [elimity-com/scim](https://github.com/elimity-com/scim/) library, which does not include authentication in its configuration by default. As a result, a SCIM server defined and exposed using this library remains unauthenticated.

```
server := scim.Server{
 Config: config,
 ResourceTypes: resourceTypes,
 }

```

To exploit an instance, you needed emails matching the configured domains. A SCIM POST operation could create a new user matching the internal email domain and data.

```
➜ curl --path-as-is -i -s -k -X $'POST' \
 -H $'Content-Type: application/scim+json'-H $'Content-Length: 377' \
 --data-binary $’{\"active\":true,\"displayName\":\"Admin\",\"emails\":[{\"value\":\
\"admin2@victim.com\"}],\"password\":\"12345678\",\"nickName\":\"Attacker\",
\"schemas\":[\"urn:ietf:params:scim:schemas:core:2.0:User\",\
\"urn:ietf:params:scim:schemas:extension:enterprise:2.0:User\"],
\"urn:ietf:params:scim:schemas:extension:enterprise:2.0:User\":{\"organization\":
\"built-in\"},\"userName\":\"admin2\",\"userType\":\"normal-user\"}' \
 $'https://<CASDOOR_INSTANCE>/scim/Users'

```

Then, you could log in to the IdP dashboard with the new admin user `admin2:12345678`.

**Note**: The maintainers released a new version (v1.812.0) that includes a fix.

While that was a simple but critical issue, bypasses could be found in authenticated implementations. In other cases, the service could be available only internally and unprotected.

### SCIM Token Management

_[\*] IdP-Side Issues_

Since SCIM secrets allow dangerous actions on the Service Providers, they should be protected from being extracted after the setup. Testing or editing an IdP SCIM integration on a configured application should require a new SCIM token if the connector URL is different from the one previously set.

A popular IdP was found to be issuing the SCIM integration test requests to `/v1/api/scim/Users?startIndex=1&count=1` with the old secret while accepting a new `baseURL`.

_+1 Extra - Covering traces_: Avoid logging errors by mocking a response JSON with the expected data for a successful SCIM integration test.
An example mock response’s JSON for a `Users` query:

```
{
    "Resources": [\
        {\
            "externalId": "<EXTID>",\
            "id": "francesco+scim@doyensec.com",\
            "meta": {\
                "created": "2024-05-29T22:15:41.649622965Z",\
                "location": "/Users/francesco+scim@doyensec.com",\
                "version": "<VERSION"\
            },\
            "schemas": [\
                "urn:ietf:params:scim:schemas:core:2.0:User"\
            ],\
            "userName": "francesco+scim@doyensec.com"\
        }\
    ],
    "itemsPerPage": 2,
    "schemas": [\
        "urn:ietf:params:scim:api:messages:2.0:ListResponse"\
    ],
    "startIndex": 1,
    "totalResults": 8
}

```

_[\*] SP-Side Issues_

The SCIM token creation & read should be allowed only to users with high privileges. Target the SP endpoints used to manage it and look for authorization issues, or target it with an XSS or other vulnerability to increase the access level in the platform.

### Unwanted User Re-provisioning Fallbacks

Since real-time user access management is the main purpose of SCIM, it is worth looking for fallbacks that cause a removed user to regain access to the SP.

For example, let’s look at the `update_scimUser` function below.

```
def can_be_reprovisioned?(usrObj)
		return true if usrObj.respond_to?(:active) && !usrObj.active?
		false

def update_scimUser(usrObj)
        # [...]
        if parser.deprovision_user?
          # [...]
        #  (o)__(o)'
        elsif can_be_reprovisioned?(usrObj)
          reprovision(usrObj)
        else
          true
        end
      end

```

Since `respond_to?(:active)` is always `true` for SCIM identities, the condition `!identity.active?` will always be true if the user is not active, causing the re-provisioning.

As a result, any SCIM update request (e.g., changing the last name) will result in re-provisioning if the user was not active for any reason (e.g., being logically banned or removed).

### Internal Attributes Manipulation

When outsourcing identity syncing to SCIM, it is important to choose what will be copied from the SCIM objects into the new internal objects. Bugs may occur if too many attributes are allowed.

_[\*] Example 1 - Privesc To Internal Roles_

A client supported provisioning and updating Okta groups and users through SCIM endpoints.

It converted Okta Groups into internal roles with custom labeling to refer to “Okta resources”. The function `resource_to_access_map` created an access mapping from the provided SCIM group resource without validating it.

```
[...]
    group_data, decode_error := decode_group_resource(resource.Attributes.AsMap())

    var role_list []string
    //  (o)__(o)'
    if resource.Id != "" {
        role_list = []string{resource.Id}
    }
    //...
    return access_map, nil, nil

```

The issue was that the role names in `role_list` were created based on an `Id` attribute (`urn:ietf:params:scim:schemas:core:2.0:Group`) passed from a third-party source.

Later, another function updated the `Role` objects, created from the SCIM event, without further checks. As a result, it was possible to overwrite any existing resource in the platform by matching its name in a SCIM Group ID.

For example, if the SCIM Group resource ID was set