---
title: Haxoris Wiki
draft: false
date: 2024-01-24
tags:
  - Code Injection
  - Security
  - Vulnerability
---

[Back to Website](https://haxoris.com/)

# Haxoris Wiki

[Print this book](https://haxoris.com/haxoris-wiki/print.html)

Code Injection is a big security problem where someone can put bad information into a program, and the program thinks it's real code and does it. This happens when the program takes what you type and uses it without checking if it's safe. If someone does this, they could control the program or even the whole computer.

It's not like SQL Injection (which is about databases) or Command Injection (which is about telling the computer what to do). Code Injection is when someone puts code in the same language the program uses, like Python or PHP. If the computer runs this bad code, the person can do things they're not supposed to, like see secret information.

One way this happens is with something called `eval()`:

```

<?php
    // Insecure PHP snippet
    $userInput = $_GET['data'];
    eval("\$variable = $userInput;");
?>

```

If someone types this:

`?data=system('cat /etc/passwd');`

the `eval()` thing will try to run that as code. If the computer isn't set up right, this could let someone do anything they want or see files they shouldn't.

Some languages can save things in a special way (like Java, PHP, Python). If a program saves something without checking it first, someone could put bad code in it. When the program opens it again, it might run that bad code. For example, in PHP:

```

<?php
    // Insecure example of unserializing user data
    $serializedData = $_POST['serialized'];
    $object = unserialize($serializedData);
    // Potentially triggers malicious constructors or methods
?>

```

If the saved thing has bad stuff in it, it could make the program run code it shouldn't.

Some programs use templates to make websites. If someone can type special things into the template, they could make the computer run code. For example:

```

# Vulnerable Python with Jinja2
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/')
def index():
    user_input = request.args.get('data')
    template = f"Hello {user_input}!"
    return render_template_string(template)

```

If the program doesn't check what someone types, they could type something like:

`/?data={{7*7}}` or `{% if ''.__class__.__mro__[1].__subclasses__()%}...`

This could make the computer run any code through Python.

Here's how to stop this:

1. **Don't Use Bad Code Helpers**
- Don't use things like `eval()` or `exec()` that run code from what someone types.
- If you have to use them, check the input very carefully and use special safety tools.
1. **Save Things Safely**
- Don't open saved things from people you don't trust.
- If you have to, use safe ways to save things (like JSON) and make sure the data is what you expect.
- Use helpers that check if the data is safe.
1. **Use Safe Templates**
- Use templates that automatically make sure what people type is safe.
- Don't let people get to important parts of the computer through the template.
1. **Check What People Type**
- Always think that what people type is bad.
- Check if it's the right kind of thing (like a number or a word) and get rid of anything that looks dangerous.
- Make sure it's safe to use in the program.
1. **Give the Program Only What It Needs**
- Only let the program do the things it needs to do.
- If someone puts bad code in, this will stop them from doing too much damage, like seeing files or using the computer.

[Reference](https://haxoris.com/)
