---
title: Haxoris Wiki
draft: false
date: 2024-01-29
tags:
  - XSS
  - Security
  - Hacking
---

[_Back to Website_](https://haxoris.com/ "Back to Website")

# Haxoris Wiki

[Print this book](https://haxoris.com/haxoris-wiki/print.html "Print this book")

Stored Cross-Site Scripting (XSS) happens when a website or app takes information from a user, saves it (like in a list or file), and then shows that information without checking it properly. This is different from reflected XSS, where the bad code is sent and used right away. With stored XSS, the bad code stays on the website. So, anyone who visits the page with the bad code can be affected without knowing it.

Because the bad code stays there, stored XSS can be more dangerous. It can affect many users over time, letting bad people steal passwords, take over accounts, spread bad software, or do things they shouldn't.

Someone puts a message with bad code on a website or blog:

```html hljs xml

<script>alert('Stored XSS');</script>

```

If the website saves this message and shows it without checking or cleaning it, everyone who sees the message will have the bad code run on their computer.

On websites where people have profiles, someone might change their profile (like their name or about section) to add bad code:

```html hljs xml

<b onmouseover="alert('Hacked!')">Hover Here</b>

```

If the website shows that code to other people (like in a list of users), they will accidentally run the bad code when they move their mouse over or look at the attacker's profile.

Even if a file doesn't look like code, some files (like pictures or documents) can have code inside them. If someone uploads a file that looks safe, but it has bad code hidden inside, and the website shows it without checking, this can also cause stored XSS.

1. **Check and Clean User Input**
   - Check all information that users put in, especially if it will be saved (like messages or profile info).
   - Use good tools that can clean HTML code (like DOMPurify for JavaScript) to remove or stop bad code.
2. **Encode Output Properly**
   - Always change the information so it's safe before putting it on HTML pages (like HTML-escaping or JavaScript-string escaping).
   - Change the information based on where it's going. For example, text in HTML needs HTML encoding, while text in JavaScript needs JavaScript string escaping.
3. **Use Content Security Policy (CSP)**
   - Use a strong Content Security Policy to only allow code from trusted sources to run.
   - Use CSP rules like script-src, object-src, and default-src to stop code from unknown sources.
4. **Control Access Properly**
   - Limit who can upload files or post HTML code, and limit what kind of code they can use.
   - Check and approve user-created content if the website is very open (like public forums).

[Reference](https://haxoris.com/haxoris-wiki/stored-cross-site-scripting-xss.html)
